!function(){angular.module("ngMaterial.components.templates",[]).run(["$templateCache",function($templateCache){$templateCache.put("date-picker/date-picker-dialog.html",'<md-dialog class="mdc-date-picker" style="max-width: 90%; max-height: 90%">\r\n    <!-- Date picker -->\r\n    <div md-theme="{{mdTheme}}">\r\n      <!-- Current day of week -->\r\n      <md-toolbar hide-sm class="md-hue-2 mdc-date-picker__current-day-of-week">\r\n        <span>{{ selected.date | date: \'EEEE\' }}</span>\r\n      </md-toolbar>\r\n\r\n      <!-- Current date -->\r\n      <md-toolbar hide-sm class="mdc-date-picker__current-date">\r\n        <span>{{ selected.date | date : \'MMMM\' }}</span>\r\n        <strong>{{ selected.date | date: \'dd\' }}</strong>\r\n        <a ng-click="displayYearSelection()">{{ selected.date | date: \'yyyy\' }}</a>\r\n      </md-toolbar>\r\n      <md-toolbar hide show-sm class="mdc-date-picker__current-date">\r\n            <strong>{{ selected.date | date: \'dd\' }}</strong>\r\n            <a ng-click="displayYearSelection()">{{ selected.date | date: \'MMMM yyyy\' }}</a>\r\n      </md-toolbar>\r\n\r\n      <!-- Calendar -->\r\n      <div class="mdc-date-picker__calendar" ng-if="!yearSelection">\r\n        <div class="mdc-date-picker__nav">\r\n          <md-button class="md-fab md-primary" aria-label="Previous month" ng-click="previousMonth()">\r\n            <i class="mdi mdi-chevron-left"></i>\r\n          </md-button>\r\n\r\n          <span>{{ activeDate | date: \'MMMM yyyy\' }}</span>\r\n\r\n          <md-button class="md-fab md-primary" aria-label="Next month" ng-click="nextMonth()">\r\n            <i class="mdi mdi-chevron-right"></i>\r\n          </md-button>\r\n        </div>\r\n\r\n        <div class="mdc-date-picker__days-of-week">\r\n          <span ng-repeat="day in daysOfWeek">{{ day }}</span>\r\n        </div>\r\n\r\n        <div class="mdc-date-picker__days">\r\n                    <span class="mdc-date-picker__day mdc-date-picker__day--is-empty"\r\n                          ng-repeat="x in emptyFirstDays">&nbsp;</span><!--\r\n\r\n                 --><div class="mdc-date-picker__day"\r\n                         ng-class="{ \'mdc-date-picker__day--is-selected\': day.selected,\r\n                                     \'mdc-date-picker__day--is-today\': day.today }"\r\n                         ng-repeat="day in days">\r\n          <a ng-click="select(day)">{{ day.date ? (day.date | date: \'dd\') : \'\' }}</a>\r\n        </div><!--\r\n\r\n                 --><span class="mdc-date-picker__day mdc-date-picker__day--is-empty"\r\n                          ng-repeat="x in emptyLastDays">&nbsp;</span>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Year selection -->\r\n      <div class="mdc-date-picker__year-selector" ng-show="yearSelection">\r\n        <a class="mdc-date-picker__year"\r\n           ng-class="{ \'mdc-date-picker__year--is-active\': year == (activeDate | date:\'yyyy\') }"\r\n           ng-repeat="year in years"\r\n           ng-click="selectYear(year)"\r\n           ng-if="yearSelection">\r\n          <span>{{year}}</span>\r\n        </a>\r\n      </div>\r\n\r\n      <!-- Actions -->\r\n      <div class="md-actions mdc-date-picker__actions" layout="row" layout-align="end end">\r\n        <md-button class="md-primary" ng-click="select(today)">Hoje</md-button>\r\n        <md-button class="md-primary" ng-click="cancel()">Cancelar</md-button>\r\n        <md-button class="md-primary" ng-click="closePicker()">Ok</md-button>\r\n      </div>\r\n    </div>\r\n</md-dialog>\r\n'),$templateCache.put("date-picker/date-picker-input.html",'<md-input-container ng-click="openPicker($event)">\r\n  <label>{{label}}</label>\r\n  <input type="text" ng-model="selected.model" ng-disabled="true" ng-click="openPicker($event)">\r\n</md-input-container>\r\n')}])}(),function(){"use strict";angular.module("ngMaterial.components.datePicker",["ngMaterial"]).controller("mdcDatePickerController",["$scope","$timeout","$mdDialog","$filter","$document","$locale","date","locale","mdTheme",function($scope,$timeout,$mdDialog,$filter,$document,$locale,date,locale,mdTheme){function checkLocale(locale){return locale?locale:(null!==navigator.language?navigator.language:navigator.browserLanguage).split("_")[0].split("-")[0]||"en"}function generateCalendar(){var days=[],firstDayOfMonth=new Date($scope.activeDate.getFullYear(),$scope.activeDate.getMonth(),1),lastDayOfMonth=new Date($scope.activeDate.getFullYear(),$scope.activeDate.getMonth()+1,0),maxDays=lastDayOfMonth.getUTCDate();$scope.emptyFirstDays=[];for(var i=firstDayOfMonth.getDay();i>0;i--)$scope.emptyFirstDays.push({});var each=firstDayOfMonth,today=new Date;today.setHours(0,0,0,0),$scope.today={},$scope.today.date=today;for(var j=0;maxDays>j;j++){var date={};date.date=each,date.selected=each.getTime()===$scope.selected.date.getTime(),date.today=each.getTime()===today.getTime(),days.push(date),each=new Date(each),each=new Date(each.setDate(each.getDate()+1))}$scope.emptyLastDays=[];for(var k=lastDayOfMonth.getDay()+1;7>k;k++)$scope.emptyLastDays.push({});$scope.days=days}$scope.myLocale=$locale,$scope.model=date,$scope.mdTheme=mdTheme?mdTheme:"default";$scope.activeDate=new Date,this.build=function(locale){angular.isDefined($scope.model)?($scope.selected={model:$scope.model,date:$scope.model},$scope.activeDate=$scope.model):($scope.selected={model:void 0,date:new Date},$scope.activeDate=new Date),$scope.days=[],$scope.daysOfWeek=[$scope.myLocale.DATETIME_FORMATS.SHORTDAY[0],$scope.myLocale.DATETIME_FORMATS.SHORTDAY[1],$scope.myLocale.DATETIME_FORMATS.SHORTDAY[2],$scope.myLocale.DATETIME_FORMATS.SHORTDAY[3],$scope.myLocale.DATETIME_FORMATS.SHORTDAY[4],$scope.myLocale.DATETIME_FORMATS.SHORTDAY[5],$scope.myLocale.DATETIME_FORMATS.SHORTDAY[6]],$scope.years=[];for(var y=$scope.activeDate.getFullYear()-50;y<=$scope.activeDate.getFullYear()+50;y++)$scope.years.push(y);generateCalendar()},this.build(checkLocale(locale)),$scope.previousMonth=function(){$scope.activeDate=new Date($scope.activeDate.getTime()),$scope.activeDate=new Date($scope.activeDate.setMonth($scope.activeDate.getMonth()-1)),generateCalendar()},$scope.nextMonth=function(){$scope.activeDate=new Date($scope.activeDate.getTime()),$scope.activeDate=new Date($scope.activeDate.setMonth($scope.activeDate.getMonth()+1)),generateCalendar()},$scope.select=function(day){$scope.selected={model:day.date,date:day.date},$scope.model=day.date,$scope.activeDate=day.date,generateCalendar()},$scope.selectYear=function(year){$scope.yearSelection=!1,$scope.selected.model=$scope.selected.date.setFullYear(year),$scope.selected.date=$scope.selected.date.setFullYear(year),$scope.model=$scope.model,$scope.activeDate.setFullYear(year),generateCalendar()},$scope.displayYearSelection=function(){var calendarHeight=$document[0].getElementsByClassName("mdc-date-picker__calendar")[0].offsetHeight,yearSelectorElement=$document[0].getElementsByClassName("mdc-date-picker__year-selector")[0];yearSelectorElement.style.height=calendarHeight+"px",$scope.yearSelection=!0,$timeout(function(){var activeYearElement=$document[0].getElementsByClassName("mdc-date-picker__year--is-active")[0];yearSelectorElement.scrollTop=yearSelectorElement.scrollTop+activeYearElement.offsetTop-yearSelectorElement.offsetHeight/2+activeYearElement.offsetHeight/2})},$scope.cancel=function(){$mdDialog.hide()},$scope.closePicker=function(){$mdDialog.hide($scope.selected)}}]).controller("mdcDatePickerInputController",function($scope,$attrs,$timeout,$filter,$mdDialog){$scope.selected=angular.isDefined($scope.model)?{model:$scope.model,date:$scope.model}:{model:void 0,date:new Date};var dataDateFormat="mediumDate";angular.isDefined($attrs.dataDateFormat)&&(dataDateFormat=$attrs.dataDateFormat),$scope.openPicker=function(ev){$scope.yearSelection=!1,$mdDialog.show({targetEvent:ev,templateUrl:"date-picker/date-picker-dialog.html",controller:"mdcDatePickerController",locals:{date:$scope.selected.date,locale:$attrs.locale,mdTheme:$attrs.dialogMdTheme}}).then(function(selected){selected&&($scope.selected.model=$filter("date")(selected.date,dataDateFormat),$scope.selected.date=selected.date,$scope.model=selected.model)})}}).directive("mdcDatePicker",function(){return{restrict:"AE",controller:"mdcDatePickerInputController",scope:{model:"=",label:"@"},templateUrl:"date-picker/date-picker-input.html"}})}(),function(){"use strict";angular.module("ngMaterial.components",["ngMaterial","ngMaterial.components.templates","ngMaterial.components.datePicker"])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi50bXAvdGVtcGxhdGVzL3RlbXBsYXRlcy5qcyIsInNyYy9kYXRlLXBpY2tlci9kYXRlLXBpY2tlci5qcyIsInNyYy9jb21wb25lbnRzLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkdGVtcGxhdGVDYWNoZSIsInB1dCIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkdGltZW91dCIsIiRtZERpYWxvZyIsIiRmaWx0ZXIiLCIkZG9jdW1lbnQiLCIkbG9jYWxlIiwiZGF0ZSIsImxvY2FsZSIsIm1kVGhlbWUiLCJjaGVja0xvY2FsZSIsIm5hdmlnYXRvciIsImxhbmd1YWdlIiwiYnJvd3Nlckxhbmd1YWdlIiwic3BsaXQiLCJnZW5lcmF0ZUNhbGVuZGFyIiwiZGF5cyIsImZpcnN0RGF5T2ZNb250aCIsIkRhdGUiLCJhY3RpdmVEYXRlIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImxhc3REYXlPZk1vbnRoIiwibWF4RGF5cyIsImdldFVUQ0RhdGUiLCJlbXB0eUZpcnN0RGF5cyIsImkiLCJnZXREYXkiLCJwdXNoIiwiZWFjaCIsInRvZGF5Iiwic2V0SG91cnMiLCJqIiwic2VsZWN0ZWQiLCJnZXRUaW1lIiwic2V0RGF0ZSIsImdldERhdGUiLCJlbXB0eUxhc3REYXlzIiwiayIsIm15TG9jYWxlIiwibW9kZWwiLCJ0aGlzIiwiYnVpbGQiLCJpc0RlZmluZWQiLCJ1bmRlZmluZWQiLCJkYXlzT2ZXZWVrIiwiREFURVRJTUVfRk9STUFUUyIsIlNIT1JUREFZIiwieWVhcnMiLCJ5IiwicHJldmlvdXNNb250aCIsInNldE1vbnRoIiwibmV4dE1vbnRoIiwic2VsZWN0IiwiZGF5Iiwic2VsZWN0WWVhciIsInllYXIiLCJ5ZWFyU2VsZWN0aW9uIiwic2V0RnVsbFllYXIiLCJkaXNwbGF5WWVhclNlbGVjdGlvbiIsImNhbGVuZGFySGVpZ2h0IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsIm9mZnNldEhlaWdodCIsInllYXJTZWxlY3RvckVsZW1lbnQiLCJzdHlsZSIsImhlaWdodCIsImFjdGl2ZVllYXJFbGVtZW50Iiwic2Nyb2xsVG9wIiwib2Zmc2V0VG9wIiwiY2FuY2VsIiwiaGlkZSIsImNsb3NlUGlja2VyIiwiJGF0dHJzIiwiZGF0YURhdGVGb3JtYXQiLCJvcGVuUGlja2VyIiwiZXYiLCJzaG93IiwidGFyZ2V0RXZlbnQiLCJ0ZW1wbGF0ZVVybCIsImxvY2FscyIsImRpYWxvZ01kVGhlbWUiLCJ0aGVuIiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJzY29wZSIsImxhYmVsIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUFBQSxRQUFBQyxPQUFBLHNDQUFBQyxLQUFBLGlCQUFBLFNBQUFDLGdCQUFBQSxlQUFBQyxJQUFBLHNDQUFBLG0wR0FDQUQsZUFBQUMsSUFBQSxxQ0FBQSwyTkNEQSxXQUdBLFlBR0FKLFNBQUFDLE9BQUEsb0NBQUEsZUFDQUksV0FBQSwyQkFBQSxTQUFBLFdBQUEsWUFBQSxVQUFBLFlBQUEsVUFBQSxPQUFBLFNBQUEsVUFDQSxTQUFBQyxPQUFBQyxTQUFBQyxVQUFBQyxRQUFBQyxVQUFBQyxRQUFBQyxLQUFBQyxPQUFBQyxTQUNBLFFBQUFDLGFBQUFGLFFBQ0EsTUFBQUEsUUFHQUEsUUFGQSxPQUFBRyxVQUFBQyxTQUFBRCxVQUFBQyxTQUFBRCxVQUFBRSxpQkFBQUMsTUFBQSxLQUFBLEdBQUFBLE1BQUEsS0FBQSxJQUFBLEtBeUdBLFFBQUFDLG9CQUNBLEdBQUFDLFNBRUFDLGdCQUFBLEdBQUFDLE1BQUFqQixPQUFBa0IsV0FBQUMsY0FBQW5CLE9BQUFrQixXQUFBRSxXQUFBLEdBQ0FDLGVBQUEsR0FBQUosTUFBQWpCLE9BQUFrQixXQUFBQyxjQUFBbkIsT0FBQWtCLFdBQUFFLFdBQUEsRUFBQSxHQUNBRSxRQUFBRCxlQUFBRSxZQUVBdkIsUUFBQXdCLGlCQUdBLEtBQUEsR0FBQUMsR0FBQVQsZ0JBQUFVLFNBQUFELEVBQUEsRUFBQUEsSUFDQXpCLE9BQUF3QixlQUFBRyxRQUdBLElBQUFDLE1BQUFaLGdCQUNBYSxNQUFBLEdBQUFaLEtBQ0FZLE9BQUFDLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQTlCLE9BQUE2QixTQUFBN0IsT0FBQTZCLE1BQUF2QixLQUFBdUIsS0FDQSxLQUFBLEdBQUFFLEdBQUEsRUFBQVQsUUFBQVMsRUFBQUEsSUFBQSxDQUVBLEdBQUF6QixRQUNBQSxNQUFBQSxLQUFBc0IsS0FHQXRCLEtBQUEwQixTQUFBSixLQUFBSyxZQUFBakMsT0FBQWdDLFNBQUExQixLQUFBMkIsVUFDQTNCLEtBQUF1QixNQUFBRCxLQUFBSyxZQUFBSixNQUFBSSxVQUVBbEIsS0FBQVksS0FBQXJCLE1BQ0FzQixLQUFBLEdBQUFYLE1BQUFXLE1BQ0FBLEtBQUEsR0FBQVgsTUFBQVcsS0FBQU0sUUFBQU4sS0FBQU8sVUFBQSxJQUdBbkMsT0FBQW9DLGdCQUVBLEtBQUEsR0FBQUMsR0FBQWhCLGVBQUFLLFNBQUEsRUFBQSxFQUFBVyxFQUFBQSxJQUNBckMsT0FBQW9DLGNBQUFULFFBR0EzQixRQUFBZSxLQUFBQSxLQTNJQWYsT0FBQXNDLFNBQUFqQyxRQUVBTCxPQUFBdUMsTUFBQWpDLEtBRUFOLE9BQUFRLFFBQUFBLFFBQUFBLFFBQUEsU0FJQVIsUUFBQWtCLFdBQUEsR0FBQUQsTUFDQXVCLEtBQUFDLE1BQUEsU0FBQWxDLFFBS0FiLFFBQUFnRCxVQUFBMUMsT0FBQXVDLFFBQ0F2QyxPQUFBZ0MsVUFDQU8sTUFBQXZDLE9BQUF1QyxNQUNBakMsS0FBQU4sT0FBQXVDLE9BR0F2QyxPQUFBa0IsV0FBQWxCLE9BQUF1QyxRQUdBdkMsT0FBQWdDLFVBQ0FPLE1BQUFJLE9BQ0FyQyxLQUFBLEdBQUFXLE9BR0FqQixPQUFBa0IsV0FBQSxHQUFBRCxPQUtBakIsT0FBQWUsUUFHQWYsT0FBQTRDLFlBQUE1QyxPQUFBc0MsU0FBQU8saUJBQUFDLFNBQUEsR0FDQTlDLE9BQUFzQyxTQUFBTyxpQkFBQUMsU0FBQSxHQUNBOUMsT0FBQXNDLFNBQUFPLGlCQUFBQyxTQUFBLEdBQ0E5QyxPQUFBc0MsU0FBQU8saUJBQUFDLFNBQUEsR0FDQTlDLE9BQUFzQyxTQUFBTyxpQkFBQUMsU0FBQSxHQUNBOUMsT0FBQXNDLFNBQUFPLGlCQUFBQyxTQUFBLEdBQ0E5QyxPQUFBc0MsU0FBQU8saUJBQUFDLFNBQUEsSUFFQTlDLE9BQUErQyxRQUVBLEtBQUEsR0FBQUMsR0FBQWhELE9BQUFrQixXQUFBQyxjQUFBLEdBQUE2QixHQUFBaEQsT0FBQWtCLFdBQUFDLGNBQUEsR0FBQTZCLElBQ0FoRCxPQUFBK0MsTUFBQXBCLEtBQUFxQixFQUdBbEMscUJBRUEwQixLQUFBQyxNQUFBaEMsWUFBQUYsU0FFQVAsT0FBQWlELGNBQUEsV0FDQWpELE9BQUFrQixXQUFBLEdBQUFELE1BQUFqQixPQUFBa0IsV0FBQWUsV0FDQWpDLE9BQUFrQixXQUFBLEdBQUFELE1BQUFqQixPQUFBa0IsV0FBQWdDLFNBQUFsRCxPQUFBa0IsV0FBQUUsV0FBQSxJQUNBTixvQkFHQWQsT0FBQW1ELFVBQUEsV0FDQW5ELE9BQUFrQixXQUFBLEdBQUFELE1BQUFqQixPQUFBa0IsV0FBQWUsV0FDQWpDLE9BQUFrQixXQUFBLEdBQUFELE1BQUFqQixPQUFBa0IsV0FBQWdDLFNBQUFsRCxPQUFBa0IsV0FBQUUsV0FBQSxJQUNBTixvQkFHQWQsT0FBQW9ELE9BQUEsU0FBQUMsS0FDQXJELE9BQUFnQyxVQUNBTyxNQUFBYyxJQUFBL0MsS0FDQUEsS0FBQStDLElBQUEvQyxNQUdBTixPQUFBdUMsTUFBQWMsSUFBQS9DLEtBQ0FOLE9BQUFrQixXQUFBbUMsSUFBQS9DLEtBRUFRLG9CQUdBZCxPQUFBc0QsV0FBQSxTQUFBQyxNQUNBdkQsT0FBQXdELGVBQUEsRUFFQXhELE9BQUFnQyxTQUFBTyxNQUFBdkMsT0FBQWdDLFNBQUExQixLQUFBbUQsWUFBQUYsTUFDQXZELE9BQUFnQyxTQUFBMUIsS0FBQU4sT0FBQWdDLFNBQUExQixLQUFBbUQsWUFBQUYsTUFDQXZELE9BQUF1QyxNQUFBdkMsT0FBQXVDLE1BQ0F2QyxPQUFBa0IsV0FBQXVDLFlBQUFGLE1BRUF6QyxvQkFFQWQsT0FBQTBELHFCQUFBLFdBQ0EsR0FBQUMsZ0JBQUF2RCxVQUFBLEdBQUF3RCx1QkFBQSw2QkFBQSxHQUFBQyxhQUNBQyxvQkFBQTFELFVBQUEsR0FBQXdELHVCQUFBLGtDQUFBLEVBQ0FFLHFCQUFBQyxNQUFBQyxPQUFBTCxlQUFBLEtBRUEzRCxPQUFBd0QsZUFBQSxFQUVBdkQsU0FBQSxXQUNBLEdBQUFnRSxtQkFBQTdELFVBQUEsR0FBQXdELHVCQUFBLG9DQUFBLEVBQ0FFLHFCQUFBSSxVQUFBSixvQkFBQUksVUFBQUQsa0JBQUFFLFVBQUFMLG9CQUFBRCxhQUFBLEVBQUFJLGtCQUFBSixhQUFBLEtBNkNBN0QsT0FBQW9FLE9BQUEsV0FDQWxFLFVBQUFtRSxRQUdBckUsT0FBQXNFLFlBQUEsV0FDQXBFLFVBQUFtRSxLQUFBckUsT0FBQWdDLGNBSUFqQyxXQUFBLCtCQUFBLFNBQUFDLE9BQUF1RSxPQUFBdEUsU0FBQUUsUUFBQUQsV0FFQUYsT0FBQWdDLFNBREF0QyxRQUFBZ0QsVUFBQTFDLE9BQUF1QyxRQUVBQSxNQUFBdkMsT0FBQXVDLE1BQ0FqQyxLQUFBTixPQUFBdUMsUUFLQUEsTUFBQUksT0FDQXJDLEtBQUEsR0FBQVcsTUFHQSxJQUFBdUQsZ0JBQUEsWUFDQTlFLFNBQUFnRCxVQUFBNkIsT0FBQUMsa0JBQ0FBLGVBQUFELE9BQUFDLGdCQUVBeEUsT0FBQXlFLFdBQUEsU0FBQUMsSUFDQTFFLE9BQUF3RCxlQUFBLEVBRUF0RCxVQUFBeUUsTUFDQUMsWUFBQUYsR0FDQUcsWUFBQSxzQ0FDQTlFLFdBQUEsMEJBQ0ErRSxRQUFBeEUsS0FBQU4sT0FBQWdDLFNBQUExQixLQUFBQyxPQUFBZ0UsT0FBQWhFLE9BQUFDLFFBQUErRCxPQUFBUSxpQkFDQUMsS0FBQSxTQUFBaEQsVUFDQUEsV0FDQWhDLE9BQUFnQyxTQUFBTyxNQUFBcEMsUUFBQSxRQUFBNkIsU0FBQTFCLEtBQUFrRSxnQkFDQXhFLE9BQUFnQyxTQUFBMUIsS0FBQTBCLFNBQUExQixLQUNBTixPQUFBdUMsTUFBQVAsU0FBQU8sWUFLQTBDLFVBQUEsZ0JBQUEsV0FDQSxPQUNBQyxTQUFBLEtBQ0FuRixXQUFBLCtCQUNBb0YsT0FDQTVDLE1BQUEsSUFDQTZDLE1BQUEsS0FFQVAsWUFBQSwyQ0NoTkEsV0FBQSxZQUVBbkYsU0FBQUMsT0FBQSx5QkFDQSxhQUNBLGtDQUNBIiwiZmlsZSI6ImFuZ3VsYXItbWF0ZXJpYWwtY29tcG9uZW50cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZShcIm5nTWF0ZXJpYWwuY29tcG9uZW50cy50ZW1wbGF0ZXNcIiwgW10pLnJ1bihbXCIkdGVtcGxhdGVDYWNoZVwiLCBmdW5jdGlvbigkdGVtcGxhdGVDYWNoZSkgeyR0ZW1wbGF0ZUNhY2hlLnB1dChcImRhdGUtcGlja2VyL2RhdGUtcGlja2VyLWRpYWxvZy5odG1sXCIsXCI8bWQtZGlhbG9nIGNsYXNzPVxcXCJtZGMtZGF0ZS1waWNrZXJcXFwiIHN0eWxlPVxcXCJtYXgtd2lkdGg6IDkwJTsgbWF4LWhlaWdodDogOTAlXFxcIj5cXHJcXG4gICAgPCEtLSBEYXRlIHBpY2tlciAtLT5cXHJcXG4gICAgPGRpdiBtZC10aGVtZT1cXFwie3ttZFRoZW1lfX1cXFwiPlxcclxcbiAgICAgIDwhLS0gQ3VycmVudCBkYXkgb2Ygd2VlayAtLT5cXHJcXG4gICAgICA8bWQtdG9vbGJhciBoaWRlLXNtIGNsYXNzPVxcXCJtZC1odWUtMiBtZGMtZGF0ZS1waWNrZXJfX2N1cnJlbnQtZGF5LW9mLXdlZWtcXFwiPlxcclxcbiAgICAgICAgPHNwYW4+e3sgc2VsZWN0ZWQuZGF0ZSB8IGRhdGU6IFxcJ0VFRUVcXCcgfX08L3NwYW4+XFxyXFxuICAgICAgPC9tZC10b29sYmFyPlxcclxcblxcclxcbiAgICAgIDwhLS0gQ3VycmVudCBkYXRlIC0tPlxcclxcbiAgICAgIDxtZC10b29sYmFyIGhpZGUtc20gY2xhc3M9XFxcIm1kYy1kYXRlLXBpY2tlcl9fY3VycmVudC1kYXRlXFxcIj5cXHJcXG4gICAgICAgIDxzcGFuPnt7IHNlbGVjdGVkLmRhdGUgfCBkYXRlIDogXFwnTU1NTVxcJyB9fTwvc3Bhbj5cXHJcXG4gICAgICAgIDxzdHJvbmc+e3sgc2VsZWN0ZWQuZGF0ZSB8IGRhdGU6IFxcJ2RkXFwnIH19PC9zdHJvbmc+XFxyXFxuICAgICAgICA8YSBuZy1jbGljaz1cXFwiZGlzcGxheVllYXJTZWxlY3Rpb24oKVxcXCI+e3sgc2VsZWN0ZWQuZGF0ZSB8IGRhdGU6IFxcJ3l5eXlcXCcgfX08L2E+XFxyXFxuICAgICAgPC9tZC10b29sYmFyPlxcclxcbiAgICAgIDxtZC10b29sYmFyIGhpZGUgc2hvdy1zbSBjbGFzcz1cXFwibWRjLWRhdGUtcGlja2VyX19jdXJyZW50LWRhdGVcXFwiPlxcclxcbiAgICAgICAgICAgIDxzdHJvbmc+e3sgc2VsZWN0ZWQuZGF0ZSB8IGRhdGU6IFxcJ2RkXFwnIH19PC9zdHJvbmc+XFxyXFxuICAgICAgICAgICAgPGEgbmctY2xpY2s9XFxcImRpc3BsYXlZZWFyU2VsZWN0aW9uKClcXFwiPnt7IHNlbGVjdGVkLmRhdGUgfCBkYXRlOiBcXCdNTU1NIHl5eXlcXCcgfX08L2E+XFxyXFxuICAgICAgPC9tZC10b29sYmFyPlxcclxcblxcclxcbiAgICAgIDwhLS0gQ2FsZW5kYXIgLS0+XFxyXFxuICAgICAgPGRpdiBjbGFzcz1cXFwibWRjLWRhdGUtcGlja2VyX19jYWxlbmRhclxcXCIgbmctaWY9XFxcIiF5ZWFyU2VsZWN0aW9uXFxcIj5cXHJcXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcIm1kYy1kYXRlLXBpY2tlcl9fbmF2XFxcIj5cXHJcXG4gICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cXFwibWQtZmFiIG1kLXByaW1hcnlcXFwiIGFyaWEtbGFiZWw9XFxcIlByZXZpb3VzIG1vbnRoXFxcIiBuZy1jbGljaz1cXFwicHJldmlvdXNNb250aCgpXFxcIj5cXHJcXG4gICAgICAgICAgICA8aSBjbGFzcz1cXFwibWRpIG1kaS1jaGV2cm9uLWxlZnRcXFwiPjwvaT5cXHJcXG4gICAgICAgICAgPC9tZC1idXR0b24+XFxyXFxuXFxyXFxuICAgICAgICAgIDxzcGFuPnt7IGFjdGl2ZURhdGUgfCBkYXRlOiBcXCdNTU1NIHl5eXlcXCcgfX08L3NwYW4+XFxyXFxuXFxyXFxuICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XFxcIm1kLWZhYiBtZC1wcmltYXJ5XFxcIiBhcmlhLWxhYmVsPVxcXCJOZXh0IG1vbnRoXFxcIiBuZy1jbGljaz1cXFwibmV4dE1vbnRoKClcXFwiPlxcclxcbiAgICAgICAgICAgIDxpIGNsYXNzPVxcXCJtZGkgbWRpLWNoZXZyb24tcmlnaHRcXFwiPjwvaT5cXHJcXG4gICAgICAgICAgPC9tZC1idXR0b24+XFxyXFxuICAgICAgICA8L2Rpdj5cXHJcXG5cXHJcXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcIm1kYy1kYXRlLXBpY2tlcl9fZGF5cy1vZi13ZWVrXFxcIj5cXHJcXG4gICAgICAgICAgPHNwYW4gbmctcmVwZWF0PVxcXCJkYXkgaW4gZGF5c09mV2Vla1xcXCI+e3sgZGF5IH19PC9zcGFuPlxcclxcbiAgICAgICAgPC9kaXY+XFxyXFxuXFxyXFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJtZGMtZGF0ZS1waWNrZXJfX2RheXNcXFwiPlxcclxcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XFxcIm1kYy1kYXRlLXBpY2tlcl9fZGF5IG1kYy1kYXRlLXBpY2tlcl9fZGF5LS1pcy1lbXB0eVxcXCJcXHJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG5nLXJlcGVhdD1cXFwieCBpbiBlbXB0eUZpcnN0RGF5c1xcXCI+Jm5ic3A7PC9zcGFuPjwhLS1cXHJcXG5cXHJcXG4gICAgICAgICAgICAgICAgIC0tPjxkaXYgY2xhc3M9XFxcIm1kYy1kYXRlLXBpY2tlcl9fZGF5XFxcIlxcclxcbiAgICAgICAgICAgICAgICAgICAgICAgICBuZy1jbGFzcz1cXFwieyBcXCdtZGMtZGF0ZS1waWNrZXJfX2RheS0taXMtc2VsZWN0ZWRcXCc6IGRheS5zZWxlY3RlZCxcXHJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFwnbWRjLWRhdGUtcGlja2VyX19kYXktLWlzLXRvZGF5XFwnOiBkYXkudG9kYXkgfVxcXCJcXHJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgbmctcmVwZWF0PVxcXCJkYXkgaW4gZGF5c1xcXCI+XFxyXFxuICAgICAgICAgIDxhIG5nLWNsaWNrPVxcXCJzZWxlY3QoZGF5KVxcXCI+e3sgZGF5LmRhdGUgPyAoZGF5LmRhdGUgfCBkYXRlOiBcXCdkZFxcJykgOiBcXCdcXCcgfX08L2E+XFxyXFxuICAgICAgICA8L2Rpdj48IS0tXFxyXFxuXFxyXFxuICAgICAgICAgICAgICAgICAtLT48c3BhbiBjbGFzcz1cXFwibWRjLWRhdGUtcGlja2VyX19kYXkgbWRjLWRhdGUtcGlja2VyX19kYXktLWlzLWVtcHR5XFxcIlxcclxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbmctcmVwZWF0PVxcXCJ4IGluIGVtcHR5TGFzdERheXNcXFwiPiZuYnNwOzwvc3Bhbj5cXHJcXG4gICAgICAgIDwvZGl2PlxcclxcbiAgICAgIDwvZGl2PlxcclxcblxcclxcbiAgICAgIDwhLS0gWWVhciBzZWxlY3Rpb24gLS0+XFxyXFxuICAgICAgPGRpdiBjbGFzcz1cXFwibWRjLWRhdGUtcGlja2VyX195ZWFyLXNlbGVjdG9yXFxcIiBuZy1zaG93PVxcXCJ5ZWFyU2VsZWN0aW9uXFxcIj5cXHJcXG4gICAgICAgIDxhIGNsYXNzPVxcXCJtZGMtZGF0ZS1waWNrZXJfX3llYXJcXFwiXFxyXFxuICAgICAgICAgICBuZy1jbGFzcz1cXFwieyBcXCdtZGMtZGF0ZS1waWNrZXJfX3llYXItLWlzLWFjdGl2ZVxcJzogeWVhciA9PSAoYWN0aXZlRGF0ZSB8IGRhdGU6XFwneXl5eVxcJykgfVxcXCJcXHJcXG4gICAgICAgICAgIG5nLXJlcGVhdD1cXFwieWVhciBpbiB5ZWFyc1xcXCJcXHJcXG4gICAgICAgICAgIG5nLWNsaWNrPVxcXCJzZWxlY3RZZWFyKHllYXIpXFxcIlxcclxcbiAgICAgICAgICAgbmctaWY9XFxcInllYXJTZWxlY3Rpb25cXFwiPlxcclxcbiAgICAgICAgICA8c3Bhbj57e3llYXJ9fTwvc3Bhbj5cXHJcXG4gICAgICAgIDwvYT5cXHJcXG4gICAgICA8L2Rpdj5cXHJcXG5cXHJcXG4gICAgICA8IS0tIEFjdGlvbnMgLS0+XFxyXFxuICAgICAgPGRpdiBjbGFzcz1cXFwibWQtYWN0aW9ucyBtZGMtZGF0ZS1waWNrZXJfX2FjdGlvbnNcXFwiIGxheW91dD1cXFwicm93XFxcIiBsYXlvdXQtYWxpZ249XFxcImVuZCBlbmRcXFwiPlxcclxcbiAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cXFwibWQtcHJpbWFyeVxcXCIgbmctY2xpY2s9XFxcInNlbGVjdCh0b2RheSlcXFwiPkhvamU8L21kLWJ1dHRvbj5cXHJcXG4gICAgICAgIDxtZC1idXR0b24gY2xhc3M9XFxcIm1kLXByaW1hcnlcXFwiIG5nLWNsaWNrPVxcXCJjYW5jZWwoKVxcXCI+Q2FuY2VsYXI8L21kLWJ1dHRvbj5cXHJcXG4gICAgICAgIDxtZC1idXR0b24gY2xhc3M9XFxcIm1kLXByaW1hcnlcXFwiIG5nLWNsaWNrPVxcXCJjbG9zZVBpY2tlcigpXFxcIj5PazwvbWQtYnV0dG9uPlxcclxcbiAgICAgIDwvZGl2PlxcclxcbiAgICA8L2Rpdj5cXHJcXG48L21kLWRpYWxvZz5cXHJcXG5cIik7XG4kdGVtcGxhdGVDYWNoZS5wdXQoXCJkYXRlLXBpY2tlci9kYXRlLXBpY2tlci1pbnB1dC5odG1sXCIsXCI8bWQtaW5wdXQtY29udGFpbmVyIG5nLWNsaWNrPVxcXCJvcGVuUGlja2VyKCRldmVudClcXFwiPlxcclxcbiAgPGxhYmVsPnt7bGFiZWx9fTwvbGFiZWw+XFxyXFxuICA8aW5wdXQgdHlwZT1cXFwidGV4dFxcXCIgbmctbW9kZWw9XFxcInNlbGVjdGVkLm1vZGVsXFxcIiBuZy1kaXNhYmxlZD1cXFwidHJ1ZVxcXCIgbmctY2xpY2s9XFxcIm9wZW5QaWNrZXIoJGV2ZW50KVxcXCI+XFxyXFxuPC9tZC1pbnB1dC1jb250YWluZXI+XFxyXFxuXCIpO31dKTsiLCIvKiBnbG9iYWwgYW5ndWxhciAqL1xyXG4vKiBnbG9iYWwgbW9tZW50ICovXHJcbi8qIGdsb2JhbCBuYXZpZ2F0b3IgKi9cclxuJ3VzZSBzdHJpY3QnOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcclxuXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbmdNYXRlcmlhbC5jb21wb25lbnRzLmRhdGVQaWNrZXInLCBbJ25nTWF0ZXJpYWwnXSlcclxuLmNvbnRyb2xsZXIoJ21kY0RhdGVQaWNrZXJDb250cm9sbGVyJywgWyckc2NvcGUnLCckdGltZW91dCcsJyRtZERpYWxvZycsJyRmaWx0ZXInLCckZG9jdW1lbnQnLCckbG9jYWxlJywnZGF0ZScsJ2xvY2FsZScsJ21kVGhlbWUnLFxyXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJHRpbWVvdXQsICRtZERpYWxvZywgJGZpbHRlciwgJGRvY3VtZW50LCAkbG9jYWxlLCBkYXRlLCBsb2NhbGUsIG1kVGhlbWUpIHtcclxuICAgICAgICBmdW5jdGlvbiBjaGVja0xvY2FsZShsb2NhbGUpIHtcclxuICAgICAgICAgIGlmICghbG9jYWxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAobmF2aWdhdG9yLmxhbmd1YWdlICE9PSBudWxsID8gbmF2aWdhdG9yLmxhbmd1YWdlIDogbmF2aWdhdG9yLmJyb3dzZXJMYW5ndWFnZSkuc3BsaXQoJ18nKVswXS5zcGxpdCgnLScpWzBdIHx8ICdlbic7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gbG9jYWxlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUubXlMb2NhbGUgPSAkbG9jYWxlO1xyXG5cclxuICAgICAgICAkc2NvcGUubW9kZWwgPSBkYXRlO1xyXG5cclxuICAgICAgICAkc2NvcGUubWRUaGVtZSA9IG1kVGhlbWUgPyBtZFRoZW1lIDogJ2RlZmF1bHQnO1xyXG5cclxuICAgICAgICB2YXIgYWN0aXZlTG9jYWxlO1xyXG5cclxuICAgICAgICAkc2NvcGUuYWN0aXZlRGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgdGhpcy5idWlsZCA9IGZ1bmN0aW9uIChsb2NhbGUpIHtcclxuICAgICAgICAgIC8vYWN0aXZlTG9jYWxlID0gbG9jYWxlO1xyXG5cclxuICAgICAgICAgIC8vbW9tZW50LmxvY2FsZShhY3RpdmVMb2NhbGUpO1xyXG5cclxuICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZCgkc2NvcGUubW9kZWwpKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHtcclxuICAgICAgICAgICAgICBtb2RlbDogJHNjb3BlLm1vZGVsLC8vbW9tZW50KCRzY29wZS5tb2RlbCksXHJcbiAgICAgICAgICAgICAgZGF0ZTogJHNjb3BlLm1vZGVsXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlRGF0ZSA9ICRzY29wZS5tb2RlbDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSB7XHJcbiAgICAgICAgICAgICAgbW9kZWw6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlRGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8kc2NvcGUubW9tZW50ID0gbW9tZW50O1xyXG5cclxuICAgICAgICAgICRzY29wZS5kYXlzID0gW107XHJcbiAgICAgICAgICAvL1RPRE86IFVzZSBtb21lbnQgbG9jYWxlIHRvIHNldCBmaXJzdCBkYXkgb2Ygd2VlayBwcm9wZXJseS5cclxuXHJcbiAgICAgICAgICAkc2NvcGUuZGF5c09mV2VlayA9IFskc2NvcGUubXlMb2NhbGUuREFURVRJTUVfRk9STUFUUy5TSE9SVERBWVswXSxcclxuICAgICAgICAgICAgJHNjb3BlLm15TG9jYWxlLkRBVEVUSU1FX0ZPUk1BVFMuU0hPUlREQVlbMV0sXHJcbiAgICAgICAgICAgICRzY29wZS5teUxvY2FsZS5EQVRFVElNRV9GT1JNQVRTLlNIT1JUREFZWzJdLFxyXG4gICAgICAgICAgICAkc2NvcGUubXlMb2NhbGUuREFURVRJTUVfRk9STUFUUy5TSE9SVERBWVszXSxcclxuICAgICAgICAgICAgJHNjb3BlLm15TG9jYWxlLkRBVEVUSU1FX0ZPUk1BVFMuU0hPUlREQVlbNF0sXHJcbiAgICAgICAgICAgICRzY29wZS5teUxvY2FsZS5EQVRFVElNRV9GT1JNQVRTLlNIT1JUREFZWzVdLFxyXG4gICAgICAgICAgICAkc2NvcGUubXlMb2NhbGUuREFURVRJTUVfRk9STUFUUy5TSE9SVERBWVs2XV07XHJcblxyXG4gICAgICAgICAgJHNjb3BlLnllYXJzID0gW107XHJcblxyXG4gICAgICAgICAgZm9yICh2YXIgeSA9ICRzY29wZS5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCkgLSA1MDsgeSA8PSAkc2NvcGUuYWN0aXZlRGF0ZS5nZXRGdWxsWWVhcigpICsgNTA7IHkrKykge1xyXG4gICAgICAgICAgICAkc2NvcGUueWVhcnMucHVzaCh5KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBnZW5lcmF0ZUNhbGVuZGFyKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmJ1aWxkKGNoZWNrTG9jYWxlKGxvY2FsZSkpO1xyXG5cclxuICAgICAgICAkc2NvcGUucHJldmlvdXNNb250aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICRzY29wZS5hY3RpdmVEYXRlID0gbmV3IERhdGUoJHNjb3BlLmFjdGl2ZURhdGUuZ2V0VGltZSgpKTtcclxuICAgICAgICAgICRzY29wZS5hY3RpdmVEYXRlID0gbmV3IERhdGUoJHNjb3BlLmFjdGl2ZURhdGUuc2V0TW9udGgoJHNjb3BlLmFjdGl2ZURhdGUuZ2V0TW9udGgoKS0xKSk7Ly8kc2NvcGUuYWN0aXZlRGF0ZS5zdWJ0cmFjdCgxLCAnbW9udGgnKTtcclxuICAgICAgICAgIGdlbmVyYXRlQ2FsZW5kYXIoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUubmV4dE1vbnRoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgJHNjb3BlLmFjdGl2ZURhdGUgPSBuZXcgRGF0ZSgkc2NvcGUuYWN0aXZlRGF0ZS5nZXRUaW1lKCkpO1xyXG4gICAgICAgICAgJHNjb3BlLmFjdGl2ZURhdGUgPSBuZXcgRGF0ZSgkc2NvcGUuYWN0aXZlRGF0ZS5zZXRNb250aCgkc2NvcGUuYWN0aXZlRGF0ZS5nZXRNb250aCgpKzEpKTsvLyRzY29wZS5hY3RpdmVEYXRlLmFkZCgxLCAnbW9udGgnKTtcclxuICAgICAgICAgIGdlbmVyYXRlQ2FsZW5kYXIoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuc2VsZWN0ID0gZnVuY3Rpb24gKGRheSkge1xyXG4gICAgICAgICAgJHNjb3BlLnNlbGVjdGVkID0ge1xyXG4gICAgICAgICAgICBtb2RlbDogZGF5LmRhdGUsXHJcbiAgICAgICAgICAgIGRhdGU6IGRheS5kYXRlXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICRzY29wZS5tb2RlbCA9IGRheS5kYXRlO1xyXG4gICAgICAgICAgJHNjb3BlLmFjdGl2ZURhdGUgPSBkYXkuZGF0ZTtcclxuXHJcbiAgICAgICAgICBnZW5lcmF0ZUNhbGVuZGFyKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnNlbGVjdFllYXIgPSBmdW5jdGlvbiAoeWVhcikge1xyXG4gICAgICAgICAgJHNjb3BlLnllYXJTZWxlY3Rpb24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQubW9kZWwgPSAkc2NvcGUuc2VsZWN0ZWQuZGF0ZS5zZXRGdWxsWWVhcih5ZWFyKTsvLyBtb21lbnQoJHNjb3BlLnNlbGVjdGVkLmRhdGUpLnllYXIoeWVhcikudG9EYXRlKCk7XHJcbiAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQuZGF0ZSA9ICAkc2NvcGUuc2VsZWN0ZWQuZGF0ZS5zZXRGdWxsWWVhcih5ZWFyKTsvL21vbWVudCgkc2NvcGUuc2VsZWN0ZWQuZGF0ZSkueWVhcih5ZWFyKS50b0RhdGUoKTtcclxuICAgICAgICAgICRzY29wZS5tb2RlbCA9ICRzY29wZS5tb2RlbDsvLyBtb21lbnQoJHNjb3BlLnNlbGVjdGVkLmRhdGUpLnRvRGF0ZSgpO1xyXG4gICAgICAgICAgJHNjb3BlLmFjdGl2ZURhdGUuc2V0RnVsbFllYXIoeWVhcik7Ly8gPSAkc2NvcGUuYWN0aXZlRGF0ZS5hZGQoeWVhciAtICRzY29wZS5hY3RpdmVEYXRlLnllYXIoKSwgJ3llYXInKTtcclxuXHJcbiAgICAgICAgICBnZW5lcmF0ZUNhbGVuZGFyKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZGlzcGxheVllYXJTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB2YXIgY2FsZW5kYXJIZWlnaHQgPSAkZG9jdW1lbnRbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbWRjLWRhdGUtcGlja2VyX19jYWxlbmRhcicpWzBdLm9mZnNldEhlaWdodDtcclxuICAgICAgICAgIHZhciB5ZWFyU2VsZWN0b3JFbGVtZW50ID0gJGRvY3VtZW50WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21kYy1kYXRlLXBpY2tlcl9feWVhci1zZWxlY3RvcicpWzBdO1xyXG4gICAgICAgICAgeWVhclNlbGVjdG9yRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBjYWxlbmRhckhlaWdodCArICdweCc7XHJcblxyXG4gICAgICAgICAgJHNjb3BlLnllYXJTZWxlY3Rpb24gPSB0cnVlO1xyXG5cclxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFjdGl2ZVllYXJFbGVtZW50ID0gJGRvY3VtZW50WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21kYy1kYXRlLXBpY2tlcl9feWVhci0taXMtYWN0aXZlJylbMF07XHJcbiAgICAgICAgICAgIHllYXJTZWxlY3RvckVsZW1lbnQuc2Nyb2xsVG9wID0geWVhclNlbGVjdG9yRWxlbWVudC5zY3JvbGxUb3AgKyBhY3RpdmVZZWFyRWxlbWVudC5vZmZzZXRUb3AgLSB5ZWFyU2VsZWN0b3JFbGVtZW50Lm9mZnNldEhlaWdodCAvIDIgKyBhY3RpdmVZZWFyRWxlbWVudC5vZmZzZXRIZWlnaHQgLyAyO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVDYWxlbmRhcigpIHtcclxuICAgICAgICAgIHZhciBkYXlzID0gW10sXHJcbiAgICAgICAgICAgIC8vcHJldmlvdXNEYXkgPSBuZXcgRGF0ZSgkc2NvcGUuYWN0aXZlRGF0ZS5nZXRGdWxsWWVhcigpLCAkc2NvcGUuYWN0aXZlRGF0ZS5nZXRNb250aCgpLCAwKSwvL2FuZ3VsYXIuY29weSgkc2NvcGUuYWN0aXZlRGF0ZSkuZGF0ZSgwKSxcclxuICAgICAgICAgICAgZmlyc3REYXlPZk1vbnRoID0gbmV3IERhdGUoJHNjb3BlLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKSwgJHNjb3BlLmFjdGl2ZURhdGUuZ2V0TW9udGgoKSwgMSksLy9hbmd1bGFyLmNvcHkoJHNjb3BlLmFjdGl2ZURhdGUpLmRhdGUoMSksXHJcbiAgICAgICAgICAgIGxhc3REYXlPZk1vbnRoID0gIG5ldyBEYXRlKCRzY29wZS5hY3RpdmVEYXRlLmdldEZ1bGxZZWFyKCksICRzY29wZS5hY3RpdmVEYXRlLmdldE1vbnRoKCkrMSwgMCksIC8vYW5ndWxhci5jb3B5KGZpcnN0RGF5T2ZNb250aCkuZW5kT2YoJ21vbnRoJyksXHJcbiAgICAgICAgICAgIG1heERheXMgPSBsYXN0RGF5T2ZNb250aC5nZXRVVENEYXRlKCk7Ly9hbmd1bGFyLmNvcHkobGFzdERheU9mTW9udGgpLmRhdGUoKTtcclxuXHJcbiAgICAgICAgICAkc2NvcGUuZW1wdHlGaXJzdERheXMgPSBbXTtcclxuXHJcblxyXG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSBmaXJzdERheU9mTW9udGguZ2V0RGF5KCk7IGkgPiAwOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgICAgJHNjb3BlLmVtcHR5Rmlyc3REYXlzLnB1c2goe30pO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB2YXIgZWFjaCA9IGZpcnN0RGF5T2ZNb250aDtcclxuICAgICAgICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcclxuICAgICAgICAgICRzY29wZS50b2RheSA9IHt9OyAkc2NvcGUudG9kYXkuZGF0ZSA9IHRvZGF5O1xyXG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBtYXhEYXlzOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBkYXRlID0ge307XHJcbiAgICAgICAgICAgIGRhdGUuZGF0ZSA9IGVhY2g7XHJcbiAgICAgICAgICAgIC8vZGF0ZSA9IGFuZ3VsYXIuY29weShwcmV2aW91c0RheS5hZGQoMSwgJ2RheXMnKSk7XHJcblxyXG4gICAgICAgICAgICBkYXRlLnNlbGVjdGVkID0gZWFjaC5nZXRUaW1lKCkgPT09ICRzY29wZS5zZWxlY3RlZC5kYXRlLmdldFRpbWUoKTsvL2FuZ3VsYXIuaXNEZWZpbmVkKCRzY29wZS5zZWxlY3RlZC5tb2RlbCkgJiYgZGF0ZS5pc1NhbWUoJHNjb3BlLnNlbGVjdGVkLmRhdGUsICdkYXknKTtcclxuICAgICAgICAgICAgZGF0ZS50b2RheSA9IGVhY2guZ2V0VGltZSgpID09PSB0b2RheS5nZXRUaW1lKCk7Ly9kYXRlLmlzU2FtZShtb21lbnQoKSwgJ2RheScpO1xyXG5cclxuICAgICAgICAgICAgZGF5cy5wdXNoKGRhdGUpO1xyXG4gICAgICAgICAgICBlYWNoID0gbmV3IERhdGUoZWFjaCk7XHJcbiAgICAgICAgICAgIGVhY2ggPSBuZXcgRGF0ZShlYWNoLnNldERhdGUoZWFjaC5nZXREYXRlKCkgKyAxKSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgJHNjb3BlLmVtcHR5TGFzdERheXMgPSBbXTtcclxuICAgICAgICAgIC8vaWYobGFzdERheU9mTW9udGguZ2V0RGF5KCkgPCA3ICkge1xyXG4gICAgICAgICAgICAgIGZvciAodmFyIGsgPSBsYXN0RGF5T2ZNb250aC5nZXREYXkoKSsxOyBrIDwgNyA7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuZW1wdHlMYXN0RGF5cy5wdXNoKHt9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAvL31cclxuICAgICAgICAgICRzY29wZS5kYXlzID0gZGF5cztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmNsb3NlUGlja2VyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgJG1kRGlhbG9nLmhpZGUoJHNjb3BlLnNlbGVjdGVkKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5dKVxyXG4uY29udHJvbGxlcignbWRjRGF0ZVBpY2tlcklucHV0Q29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRhdHRycywgJHRpbWVvdXQsICRmaWx0ZXIsICRtZERpYWxvZykge1xyXG4gICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKCRzY29wZS5tb2RlbCkpIHtcclxuICAgICAgJHNjb3BlLnNlbGVjdGVkID0ge1xyXG4gICAgICAgIG1vZGVsOiAkc2NvcGUubW9kZWwsXHJcbiAgICAgICAgZGF0ZTogJHNjb3BlLm1vZGVsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgJHNjb3BlLnNlbGVjdGVkID0ge1xyXG4gICAgICAgIG1vZGVsOiB1bmRlZmluZWQsXHJcbiAgICAgICAgZGF0ZTogbmV3IERhdGUoKVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgdmFyIGRhdGFEYXRlRm9ybWF0ID0gJ21lZGl1bURhdGUnO1xyXG4gICAgaWYoYW5ndWxhci5pc0RlZmluZWQoJGF0dHJzLmRhdGFEYXRlRm9ybWF0KSlcclxuICAgICAgICBkYXRhRGF0ZUZvcm1hdCA9ICRhdHRycy5kYXRhRGF0ZUZvcm1hdDtcclxuXHJcbiAgICAkc2NvcGUub3BlblBpY2tlciA9IGZ1bmN0aW9uIChldikge1xyXG4gICAgICAkc2NvcGUueWVhclNlbGVjdGlvbiA9IGZhbHNlO1xyXG5cclxuICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgIHRhcmdldEV2ZW50OiBldixcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2RhdGUtcGlja2VyL2RhdGUtcGlja2VyLWRpYWxvZy5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiAnbWRjRGF0ZVBpY2tlckNvbnRyb2xsZXInLFxyXG4gICAgICAgIGxvY2Fsczoge2RhdGU6ICRzY29wZS5zZWxlY3RlZC5kYXRlLCBsb2NhbGU6ICRhdHRycy5sb2NhbGUsIG1kVGhlbWU6ICRhdHRycy5kaWFsb2dNZFRoZW1lfVxyXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZCkge1xyXG4gICAgICAgIGlmIChzZWxlY3RlZCkge1xyXG4gICAgICAgICAgJHNjb3BlLnNlbGVjdGVkLm1vZGVsID0gJGZpbHRlcignZGF0ZScpKHNlbGVjdGVkLmRhdGUsIGRhdGFEYXRlRm9ybWF0KTtcclxuICAgICAgICAgICRzY29wZS5zZWxlY3RlZC5kYXRlID0gc2VsZWN0ZWQuZGF0ZTtcclxuICAgICAgICAgICRzY29wZS5tb2RlbCA9IHNlbGVjdGVkLm1vZGVsO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG4gIH0pXHJcbi5kaXJlY3RpdmUoJ21kY0RhdGVQaWNrZXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXN0cmljdDogJ0FFJyxcclxuICAgICAgY29udHJvbGxlcjogJ21kY0RhdGVQaWNrZXJJbnB1dENvbnRyb2xsZXInLFxyXG4gICAgICBzY29wZToge1xyXG4gICAgICAgIG1vZGVsOiAnPScsXHJcbiAgICAgICAgbGFiZWw6ICdAJ1xyXG4gICAgICB9LFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJ2RhdGUtcGlja2VyL2RhdGUtcGlja2VyLWlucHV0Lmh0bWwnXHJcbiAgICB9O1xyXG4gIH0pO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbmdNYXRlcmlhbC5jb21wb25lbnRzJywgW1xyXG4gICduZ01hdGVyaWFsJyxcclxuICAnbmdNYXRlcmlhbC5jb21wb25lbnRzLnRlbXBsYXRlcycsXHJcbiAgJ25nTWF0ZXJpYWwuY29tcG9uZW50cy5kYXRlUGlja2VyJ1xyXG5dKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9